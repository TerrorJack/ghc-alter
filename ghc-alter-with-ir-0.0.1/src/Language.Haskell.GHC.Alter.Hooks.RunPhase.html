<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Alter</span><span class="hs-operator">.</span><span class="hs-identifier">Hooks</span><span class="hs-operator">.</span><span class="hs-identifier">RunPhase</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#defaultRunPhase"><span class="hs-identifier hs-var">defaultRunPhase</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#runPhaseWith"><span class="hs-identifier hs-var">runPhaseWith</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Cmm</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CmmBuildInfoTables</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CmmInfo</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CmmPipeline</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CodeOutput</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CorePrep</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreSyn</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreToStg</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CostCentre</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DriverPipeline</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ErrUtils</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HscMain</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HscTypes</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hsc</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Module</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">PipelineMonad</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Platform</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ProfInit</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SimplStg</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">StgCmm</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">StgSyn</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Stream</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCon</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UniqSupply</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="RunPhase"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier">RunPhase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RunPhase"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier">RunPhase</span></a></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="onenter"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#onenter"><span class="hs-identifier">onenter</span></a></a><span class="hs-special">,</span><span> </span><a name="onleave"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#onleave"><span class="hs-identifier">onleave</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PhasePlus</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="core"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#core"><span class="hs-identifier">core</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CgGuts</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="stg"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#stg"><span class="hs-identifier">stg</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">StgTopBinding</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="cmm"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#cmm"><span class="hs-identifier">cmm</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Stream</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Stream</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CmmGroup</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="cmmRaw"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#cmmRaw"><span class="hs-identifier">cmmRaw</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Stream</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Stream</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">RawCmmGroup</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-identifier">defaultRunPhase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span>
</span><a name="line-46"></a><a name="defaultRunPhase"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#defaultRunPhase"><span class="hs-identifier">defaultRunPhase</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-47"></a><span>  </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-var">RunPhase</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">onenter</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106014"><span class="hs-identifier hs-var">three</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">onleave</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106014"><span class="hs-identifier hs-var">three</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">core</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106015"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">stg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106015"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cmm</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106015"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cmmRaw</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106015"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-56"></a><span>    </span><a name="local-6989586621679106014"><a href="#local-6989586621679106014"><span class="hs-identifier">three</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106015"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-57"></a><span>    </span><a name="local-6989586621679106015"><a href="#local-6989586621679106015"><span class="hs-identifier">two</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-identifier">myCoreToStgWith</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-60"></a><span>     </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Module</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoreProgram</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">StgTopBinding</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CollectedCCs</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><a name="myCoreToStgWith"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#myCoreToStgWith"><span class="hs-identifier">myCoreToStgWith</span></a></a><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-var">RunPhase</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679106022"><a href="#local-6989586621679106022"><span class="hs-identifier">mod_summary</span></a></a><span> </span><a name="local-6989586621679106023"><a href="#local-6989586621679106023"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679106024"><a href="#local-6989586621679106024"><span class="hs-identifier">this_mod</span></a></a><span> </span><a name="local-6989586621679106025"><a href="#local-6989586621679106025"><span class="hs-identifier">prepd_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106026"><a href="#local-6989586621679106026"><span class="hs-identifier">stg_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">coreToStg</span><span> </span><a href="#local-6989586621679106023"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679106024"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-6989586621679106025"><span class="hs-identifier hs-var">prepd_binds</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679106027"><a href="#local-6989586621679106027"><span class="hs-identifier">stg_binds2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679106028"><a href="#local-6989586621679106028"><span class="hs-identifier">cost_centre_info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">stg2stg</span><span> </span><a href="#local-6989586621679106023"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679106024"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-6989586621679106026"><span class="hs-identifier hs-var">stg_binds</span></a><span>
</span><a name="line-69"></a><span>  </span><a href="#local-6989586621679106019"><span class="hs-identifier hs-var">stg</span></a><span> </span><a href="#local-6989586621679106022"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106027"><span class="hs-identifier hs-var">stg_binds2</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679106027"><span class="hs-identifier hs-var">stg_binds2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679106028"><span class="hs-identifier hs-var">cost_centre_info</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-identifier">doCodeGenWith</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-73"></a><span>     </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HscEnv</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Module</span><span>
</span><a name="line-77"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyCon</span><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CollectedCCs</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">StgTopBinding</span><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HpcInfo</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Stream</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Stream</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CmmGroup</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><a name="doCodeGenWith"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#doCodeGenWith"><span class="hs-identifier">doCodeGenWith</span></a></a><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-var">RunPhase</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679106035"><a href="#local-6989586621679106035"><span class="hs-identifier">mod_summary</span></a></a><span> </span><a name="local-6989586621679106036"><a href="#local-6989586621679106036"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-6989586621679106037"><a href="#local-6989586621679106037"><span class="hs-identifier">this_mod</span></a></a><span> </span><a name="local-6989586621679106038"><a href="#local-6989586621679106038"><span class="hs-identifier">data_tycons</span></a></a><span> </span><a name="local-6989586621679106039"><a href="#local-6989586621679106039"><span class="hs-identifier">cost_centre_info</span></a></a><span> </span><a name="local-6989586621679106040"><a href="#local-6989586621679106040"><span class="hs-identifier">stg_binds</span></a></a><span> </span><a name="local-6989586621679106041"><a href="#local-6989586621679106041"><span class="hs-identifier">hpc_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106042"><a href="#local-6989586621679106042"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><a href="#local-6989586621679106036"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">cmm_stream</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Stream</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Stream</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CmmGroup</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>      </span><a name="local-6989586621679106043"><a href="#local-6989586621679106043"><span class="hs-identifier">cmm_stream</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-86"></a><span>        </span><span class="hs-identifier hs-var">StgCmm</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">codeGen</span><span>
</span><a name="line-87"></a><span>          </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-88"></a><span>          </span><a href="#local-6989586621679106037"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-89"></a><span>          </span><a href="#local-6989586621679106038"><span class="hs-identifier hs-var">data_tycons</span></a><span>
</span><a name="line-90"></a><span>          </span><a href="#local-6989586621679106039"><span class="hs-identifier hs-var">cost_centre_info</span></a><span>
</span><a name="line-91"></a><span>          </span><a href="#local-6989586621679106040"><span class="hs-identifier hs-var">stg_binds</span></a><span>
</span><a name="line-92"></a><span>          </span><a href="#local-6989586621679106041"><span class="hs-identifier hs-var">hpc_info</span></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106044"><a href="#local-6989586621679106044"><span class="hs-identifier">dump1</span></a></a><span> </span><a name="local-6989586621679106046"><a href="#local-6989586621679106046"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-94"></a><span>        </span><span class="hs-identifier hs-var">dumpIfSet_dyn</span><span>
</span><a name="line-95"></a><span>          </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-96"></a><span>          </span><span class="hs-identifier hs-var">Opt_D_dump_cmm_from_stg</span><span>
</span><a name="line-97"></a><span>          </span><span class="hs-string">&quot;Cmm produced by codegen&quot;</span><span>
</span><a name="line-98"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679106046"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679106046"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-100"></a><span>      </span><a name="local-6989586621679106045"><a href="#local-6989586621679106045"><span class="hs-identifier">ppr_stream1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679106044"><span class="hs-identifier hs-var">dump1</span></a><span> </span><a href="#local-6989586621679106043"><span class="hs-identifier hs-var">cmm_stream</span></a><span>
</span><a name="line-101"></a><span>  </span><a name="local-6989586621679106047"><a href="#local-6989586621679106047"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mkSplitUniqSupply</span><span> </span><span class="hs-char">'S'</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106048"><a href="#local-6989586621679106048"><span class="hs-identifier">pipeline_stream</span></a></a><span>
</span><a name="line-103"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">gopt</span><span> </span><span class="hs-identifier hs-var">Opt_SplitObjs</span><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-104"></a><span>            </span><span class="hs-identifier hs-var">gopt</span><span> </span><span class="hs-identifier hs-var">Opt_SplitSections</span><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-105"></a><span>            </span><span class="hs-identifier hs-var">osSubsectionsViaSymbols</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">platformOS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-106"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106049"><a href="#local-6989586621679106049"><span class="hs-identifier">run_pipeline</span></a></a><span> </span><a name="local-6989586621679106050"><a href="#local-6989586621679106050"><span class="hs-identifier">us_</span></a></a><span> </span><a name="local-6989586621679106051"><a href="#local-6989586621679106051"><span class="hs-identifier">cmmgroup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-107"></a><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679106052"><a href="#local-6989586621679106052"><span class="hs-identifier">topSRT'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679106053"><a href="#local-6989586621679106053"><span class="hs-identifier">us'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">initUs</span><span> </span><a href="#local-6989586621679106050"><span class="hs-identifier hs-var">us_</span></a><span> </span><span class="hs-identifier hs-var">emptySRT</span><span>
</span><a name="line-108"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679106054"><a href="#local-6989586621679106054"><span class="hs-identifier">topSRT</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679106055"><a href="#local-6989586621679106055"><span class="hs-identifier">cmmgroup'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">cmmPipeline</span><span> </span><a href="#local-6989586621679106036"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="#local-6989586621679106052"><span class="hs-identifier hs-var">topSRT'</span></a><span> </span><a href="#local-6989586621679106051"><span class="hs-identifier hs-var">cmmgroup</span></a><span>
</span><a name="line-109"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106056"><a href="#local-6989586621679106056"><span class="hs-identifier">srt</span></a></a><span>
</span><a name="line-110"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isEmptySRT</span><span> </span><a href="#local-6989586621679106054"><span class="hs-identifier hs-var">topSRT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">srtToData</span><span> </span><a href="#local-6989586621679106054"><span class="hs-identifier hs-var">topSRT</span></a><span>
</span><a name="line-112"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679106053"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679106056"><span class="hs-identifier hs-var">srt</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679106055"><span class="hs-identifier hs-var">cmmgroup'</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapAccumL</span><span> </span><a href="#local-6989586621679106049"><span class="hs-identifier hs-var">run_pipeline</span></a><span> </span><a href="#local-6989586621679106047"><span class="hs-identifier hs-var">us</span></a><span> </span><a href="#local-6989586621679106045"><span class="hs-identifier hs-var">ppr_stream1</span></a><span>
</span><a name="line-114"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-116"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106057"><a href="#local-6989586621679106057"><span class="hs-identifier">initTopSRT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">initUs_</span><span> </span><a href="#local-6989586621679106047"><span class="hs-identifier hs-var">us</span></a><span> </span><span class="hs-identifier hs-var">emptySRT</span><span>
</span><a name="line-117"></a><span>              </span><a name="local-6989586621679106058"><a href="#local-6989586621679106058"><span class="hs-identifier">run_pipeline</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmPipeline</span><span> </span><a href="#local-6989586621679106036"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-118"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679106059"><a href="#local-6989586621679106059"><span class="hs-identifier">topSRT</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapAccumL</span><span> </span><a href="#local-6989586621679106058"><span class="hs-identifier hs-var">run_pipeline</span></a><span> </span><a href="#local-6989586621679106057"><span class="hs-identifier hs-var">initTopSRT</span></a><span> </span><a href="#local-6989586621679106045"><span class="hs-identifier hs-var">ppr_stream1</span></a><span>
</span><a name="line-119"></a><span>                </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">yield</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">srtToData</span><span> </span><a href="#local-6989586621679106059"><span class="hs-identifier hs-var">topSRT</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>  </span><a href="#local-6989586621679106033"><span class="hs-identifier hs-var">cmm</span></a><span> </span><a href="#local-6989586621679106035"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106048"><span class="hs-identifier hs-var">pipeline_stream</span></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106060"><a href="#local-6989586621679106060"><span class="hs-identifier">dump2</span></a></a><span> </span><a name="local-6989586621679106062"><a href="#local-6989586621679106062"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-122"></a><span>        </span><span class="hs-identifier hs-var">dumpIfSet_dyn</span><span> </span><a href="#local-6989586621679106042"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-identifier hs-var">Opt_D_dump_cmm</span><span> </span><span class="hs-string">&quot;Output Cmm&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679106062"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679106062"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-124"></a><span>      </span><a name="local-6989586621679106061"><a href="#local-6989586621679106061"><span class="hs-identifier">ppr_stream2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679106060"><span class="hs-identifier hs-var">dump2</span></a><span> </span><a href="#local-6989586621679106048"><span class="hs-identifier hs-var">pipeline_stream</span></a><span>
</span><a name="line-125"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679106061"><span class="hs-identifier hs-var">ppr_stream2</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">hscGenHardCodeWith</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-128"></a><span>     </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HscEnv</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CgGuts</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ForeignSrcLang</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><a name="hscGenHardCodeWith"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#hscGenHardCodeWith"><span class="hs-identifier">hscGenHardCodeWith</span></a></a><span> </span><a name="local-6989586621679106063"><a href="#local-6989586621679106063"><span class="hs-identifier">rp</span></a></a><span class="hs-glyph">@</span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-var">RunPhase</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679106070"><a href="#local-6989586621679106070"><span class="hs-identifier">hsc_env</span></a></a><span> </span><a name="local-6989586621679106071"><a href="#local-6989586621679106071"><span class="hs-identifier">cgguts</span></a></a><span> </span><a name="local-6989586621679106072"><a href="#local-6989586621679106072"><span class="hs-identifier">mod_summary</span></a></a><span> </span><a name="local-6989586621679106073"><a href="#local-6989586621679106073"><span class="hs-identifier">output_filename</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">CgGuts</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cg_module</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106074"><a href="#local-6989586621679106074"><span class="hs-identifier">this_mod</span></a></a><span>
</span><a name="line-136"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106075"><a href="#local-6989586621679106075"><span class="hs-identifier">core_binds</span></a></a><span>
</span><a name="line-137"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_tycons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106076"><a href="#local-6989586621679106076"><span class="hs-identifier">tycons</span></a></a><span>
</span><a name="line-138"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_foreign</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106077"><a href="#local-6989586621679106077"><span class="hs-identifier">foreign_stubs0</span></a></a><span>
</span><a name="line-139"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_foreign_files</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106078"><a href="#local-6989586621679106078"><span class="hs-identifier">foreign_files</span></a></a><span>
</span><a name="line-140"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_dep_pkgs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106079"><a href="#local-6989586621679106079"><span class="hs-identifier">dependencies</span></a></a><span>
</span><a name="line-141"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cg_hpc_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106080"><a href="#local-6989586621679106080"><span class="hs-identifier">hpc_info</span></a></a><span>
</span><a name="line-142"></a><span>             </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106071"><span class="hs-identifier hs-var">cgguts</span></a><span>
</span><a name="line-143"></a><span>      </span><a name="local-6989586621679106081"><a href="#local-6989586621679106081"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_dflags</span><span> </span><a href="#local-6989586621679106070"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-144"></a><span>      </span><a name="local-6989586621679106082"><a href="#local-6989586621679106082"><span class="hs-identifier">location</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ms_location</span><span> </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-var">mod_summary</span></a><span>
</span><a name="line-145"></a><span>      </span><a name="local-6989586621679106083"><a href="#local-6989586621679106083"><span class="hs-identifier">data_tycons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-identifier hs-var">isDataTyCon</span><span> </span><a href="#local-6989586621679106076"><span class="hs-identifier hs-var">tycons</span></a><span>
</span><a name="line-146"></a><span>  </span><a name="local-6989586621679106263"><a href="#local-6989586621679106263"><span class="hs-identifier">prepd_binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">corePrepPgm</span><span> </span><a href="#local-6989586621679106070"><span class="hs-identifier hs-var">hsc_env</span></a><span> </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-6989586621679106082"><span class="hs-identifier hs-var">location</span></a><span> </span><a href="#local-6989586621679106075"><span class="hs-identifier hs-var">core_binds</span></a><span> </span><a href="#local-6989586621679106083"><span class="hs-identifier hs-var">data_tycons</span></a><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679106264"><a href="#local-6989586621679106264"><span class="hs-identifier">stg_binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679106265"><a href="#local-6989586621679106265"><span class="hs-identifier">cost_centre_info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-148"></a><span>    </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#myCoreToStgWith"><span class="hs-identifier hs-var">myCoreToStgWith</span></a><span> </span><a href="#local-6989586621679106063"><span class="hs-identifier hs-var">rp</span></a><span> </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106081"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-6989586621679106263"><span class="hs-identifier hs-var">prepd_binds</span></a><span>
</span><a name="line-149"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106266"><a href="#local-6989586621679106266"><span class="hs-identifier">prof_init</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">profilingInitCode</span><span> </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span> </span><a href="#local-6989586621679106265"><span class="hs-identifier hs-var">cost_centre_info</span></a><span>
</span><a name="line-150"></a><span>      </span><a name="local-6989586621679106267"><a href="#local-6989586621679106267"><span class="hs-identifier">foreign_stubs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679106077"><span class="hs-identifier hs-var">foreign_stubs0</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appendStubC</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679106266"><span class="hs-identifier hs-var">prof_init</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-identifier hs-var">withTiming</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679106081"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;CodeGen&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">brackets</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-155"></a><span>    </span><a name="local-6989586621679106268"><a href="#local-6989586621679106268"><span class="hs-identifier">cmms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-156"></a><span>      </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#doCodeGenWith"><span class="hs-identifier hs-var">doCodeGenWith</span></a><span>
</span><a name="line-157"></a><span>        </span><a href="#local-6989586621679106063"><span class="hs-identifier hs-var">rp</span></a><span>
</span><a name="line-158"></a><span>        </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-var">mod_summary</span></a><span>
</span><a name="line-159"></a><span>        </span><a href="#local-6989586621679106070"><span class="hs-identifier hs-var">hsc_env</span></a><span>
</span><a name="line-160"></a><span>        </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-161"></a><span>        </span><a href="#local-6989586621679106083"><span class="hs-identifier hs-var">data_tycons</span></a><span>
</span><a name="line-162"></a><span>        </span><a href="#local-6989586621679106265"><span class="hs-identifier hs-var">cost_centre_info</span></a><span>
</span><a name="line-163"></a><span>        </span><a href="#local-6989586621679106264"><span class="hs-identifier hs-var">stg_binds</span></a><span>
</span><a name="line-164"></a><span>        </span><a href="#local-6989586621679106080"><span class="hs-identifier hs-var">hpc_info</span></a><span>
</span><a name="line-165"></a><span>    </span><a name="local-6989586621679106269"><a href="#local-6989586621679106269"><span class="hs-identifier">rawcmms0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">cmmToRawCmm</span><span> </span><a href="#local-6989586621679106081"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679106268"><span class="hs-identifier hs-var">cmms</span></a><span>
</span><a name="line-166"></a><span>    </span><a href="#local-6989586621679106069"><span class="hs-identifier hs-var">cmmRaw</span></a><span> </span><a href="#local-6989586621679106072"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106269"><span class="hs-identifier hs-var">rawcmms0</span></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106270"><a href="#local-6989586621679106270"><span class="hs-identifier">dump</span></a></a><span> </span><a name="local-6989586621679106272"><a href="#local-6989586621679106272"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-168"></a><span>          </span><span class="hs-identifier hs-var">dumpIfSet_dyn</span><span> </span><a href="#local-6989586621679106081"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-identifier hs-var">Opt_D_dump_cmm_raw</span><span> </span><span class="hs-string">&quot;Raw Cmm&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679106272"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679106272"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-170"></a><span>        </span><a name="local-6989586621679106271"><a href="#local-6989586621679106271"><span class="hs-identifier">rawcmms1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Stream</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679106270"><span class="hs-identifier hs-var">dump</span></a><span> </span><a href="#local-6989586621679106269"><span class="hs-identifier hs-var">rawcmms0</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679106273"><a href="#local-6989586621679106273"><span class="hs-identifier">output_filename'</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679106274"><a href="#local-6989586621679106274"><span class="hs-identifier">_stub_h_exists</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679106275"><a href="#local-6989586621679106275"><span class="hs-identifier">stub_c_exists</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679106276"><a href="#local-6989586621679106276"><span class="hs-identifier">foreign_fps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-172"></a><span>      </span><span class="hs-identifier hs-var">codeOutput</span><span>
</span><a name="line-173"></a><span>        </span><a href="#local-6989586621679106081"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-174"></a><span>        </span><a href="#local-6989586621679106074"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-175"></a><span>        </span><a href="#local-6989586621679106073"><span class="hs-identifier hs-var">output_filename</span></a><span>
</span><a name="line-176"></a><span>        </span><a href="#local-6989586621679106082"><span class="hs-identifier hs-var">location</span></a><span>
</span><a name="line-177"></a><span>        </span><a href="#local-6989586621679106267"><span class="hs-identifier hs-var">foreign_stubs</span></a><span>
</span><a name="line-178"></a><span>        </span><a href="#local-6989586621679106078"><span class="hs-identifier hs-var">foreign_files</span></a><span>
</span><a name="line-179"></a><span>        </span><a href="#local-6989586621679106079"><span class="hs-identifier hs-var">dependencies</span></a><span>
</span><a name="line-180"></a><span>        </span><a href="#local-6989586621679106271"><span class="hs-identifier hs-var">rawcmms1</span></a><span>
</span><a name="line-181"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679106273"><span class="hs-identifier hs-var">output_filename'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679106275"><span class="hs-identifier hs-var">stub_c_exists</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679106276"><span class="hs-identifier hs-var">foreign_fps</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">runPhaseWith</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-184"></a><span>     </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-type">RunPhase</span></a><span>
</span><a name="line-185"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PhasePlus</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CompPipeline</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PhasePlus</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><a name="runPhaseWith"><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#runPhaseWith"><span class="hs-identifier">runPhaseWith</span></a></a><span> </span><a name="local-6989586621679106277"><a href="#local-6989586621679106277"><span class="hs-identifier">rp</span></a></a><span class="hs-glyph">@</span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#RunPhase"><span class="hs-identifier hs-var">RunPhase</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679106284"><a href="#local-6989586621679106284"><span class="hs-identifier">phase_plus</span></a></a><span> </span><a name="local-6989586621679106285"><a href="#local-6989586621679106285"><span class="hs-identifier">input_fn</span></a></a><span> </span><a name="local-6989586621679106286"><a href="#local-6989586621679106286"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679106278"><span class="hs-identifier hs-var">onenter</span></a><span> </span><a href="#local-6989586621679106284"><span class="hs-identifier hs-var">phase_plus</span></a><span> </span><a href="#local-6989586621679106285"><span class="hs-identifier hs-var">input_fn</span></a><span> </span><a href="#local-6989586621679106286"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-191"></a><span>  </span><a name="local-6989586621679106297"><a href="#local-6989586621679106297"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679106284"><span class="hs-identifier hs-var">phase_plus</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-193"></a><span>      </span><span class="hs-identifier hs-var">HscOut</span><span> </span><a name="local-6989586621679106287"><a href="#local-6989586621679106287"><span class="hs-identifier">src_flavour</span></a></a><span> </span><a name="local-6989586621679106288"><a href="#local-6989586621679106288"><span class="hs-identifier">mod_name</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HscRecomp</span><span> </span><a name="local-6989586621679106289"><a href="#local-6989586621679106289"><span class="hs-identifier">cgguts</span></a></a><span> </span><a name="local-6989586621679106290"><a href="#local-6989586621679106290"><span class="hs-identifier">mod_summary</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679106280"><span class="hs-identifier hs-var">core</span></a><span> </span><a href="#local-6989586621679106290"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106289"><span class="hs-identifier hs-var">cgguts</span></a><span>
</span><a name="line-195"></a><span>        </span><a name="local-6989586621679106291"><a href="#local-6989586621679106291"><span class="hs-identifier">location</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getLocation</span><span> </span><a href="#local-6989586621679106287"><span class="hs-identifier hs-var">src_flavour</span></a><span> </span><a href="#local-6989586621679106288"><span class="hs-identifier hs-var">mod_name</span></a><span>
</span><a name="line-196"></a><span>        </span><span class="hs-identifier hs-var">setModLocation</span><span> </span><a href="#local-6989586621679106291"><span class="hs-identifier hs-var">location</span></a><span>
</span><a name="line-197"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679106292"><a href="#local-6989586621679106292"><span class="hs-identifier">hsc_lang</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hscTarget</span><span> </span><a href="#local-6989586621679106286"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-198"></a><span>            </span><a name="local-6989586621679106293"><a href="#local-6989586621679106293"><span class="hs-identifier">next_phase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hscPostBackendPhase</span><span> </span><a href="#local-6989586621679106286"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679106287"><span class="hs-identifier hs-var">src_flavour</span></a><span> </span><a href="#local-6989586621679106292"><span class="hs-identifier hs-var">hsc_lang</span></a><span>
</span><a name="line-199"></a><span>        </span><a name="local-6989586621679106294"><a href="#local-6989586621679106294"><span class="hs-identifier">output_fn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">phaseOutputFilename</span><span> </span><a href="#local-6989586621679106293"><span class="hs-identifier hs-var">next_phase</span></a><span>
</span><a name="line-200"></a><span>        </span><span class="hs-identifier hs-var">PipeState</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">hsc_env</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679106295"><a href="#local-6989586621679106295"><span class="hs-identifier">hsc_env'</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getPipeState</span><span>
</span><a name="line-201"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679106296"><a href="#local-6989586621679106296"><span class="hs-identifier">outputFilename</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-202"></a><span>          </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Language.Haskell.GHC.Alter.Hooks.RunPhase.html#hscGenHardCodeWith"><span class="hs-identifier hs-var">hscGenHardCodeWith</span></a><span> </span><a href="#local-6989586621679106277"><span class="hs-identifier hs-var">rp</span></a><span> </span><a href="#local-6989586621679106295"><span class="hs-identifier hs-var">hsc_env'</span></a><span> </span><a href="#local-6989586621679106289"><span class="hs-identifier hs-var">cgguts</span></a><span> </span><a href="#local-6989586621679106290"><span class="hs-identifier hs-var">mod_summary</span></a><span> </span><a href="#local-6989586621679106294"><span class="hs-identifier hs-var">output_fn</span></a><span>
</span><a name="line-203"></a><span>        </span><span class="hs-identifier hs-var">setForeignOs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-204"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RealPhase</span><span> </span><a href="#local-6989586621679106293"><span class="hs-identifier hs-var">next_phase</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679106296"><span class="hs-identifier hs-var">outputFilename</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">runPhase</span><span> </span><a href="#local-6989586621679106284"><span class="hs-identifier hs-var">phase_plus</span></a><span> </span><a href="#local-6989586621679106285"><span class="hs-identifier hs-var">input_fn</span></a><span> </span><a href="#local-6989586621679106286"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679106279"><span class="hs-identifier hs-var">onleave</span></a><span> </span><a href="#local-6989586621679106284"><span class="hs-identifier hs-var">phase_plus</span></a><span> </span><a href="#local-6989586621679106285"><span class="hs-identifier hs-var">input_fn</span></a><span> </span><a href="#local-6989586621679106286"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679106297"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-208"></a></pre></body></html>