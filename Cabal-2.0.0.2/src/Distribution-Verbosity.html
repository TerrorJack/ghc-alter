<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Distribution/Verbosity.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE DeriveGeneric #-}</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-4"></a><span class='hs-comment'>-- |</span>
<a name="line-5"></a><span class='hs-comment'>-- Module      :  Distribution.Verbosity</span>
<a name="line-6"></a><span class='hs-comment'>-- Copyright   :  Ian Lynagh 2007</span>
<a name="line-7"></a><span class='hs-comment'>-- License     :  BSD3</span>
<a name="line-8"></a><span class='hs-comment'>--</span>
<a name="line-9"></a><span class='hs-comment'>-- Maintainer  :  cabal-devel@haskell.org</span>
<a name="line-10"></a><span class='hs-comment'>-- Portability :  portable</span>
<a name="line-11"></a><span class='hs-comment'>--</span>
<a name="line-12"></a><span class='hs-comment'>-- A 'Verbosity' type with associated utilities.</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-- There are 4 standard verbosity levels from 'silent', 'normal',</span>
<a name="line-15"></a><span class='hs-comment'>-- 'verbose' up to 'deafening'. This is used for deciding what logging</span>
<a name="line-16"></a><span class='hs-comment'>-- messages to print.</span>
<a name="line-17"></a><span class='hs-comment'>--</span>
<a name="line-18"></a><span class='hs-comment'>-- Verbosity also is equipped with some internal settings which can be</span>
<a name="line-19"></a><span class='hs-comment'>-- used to control at a fine granularity the verbosity of specific</span>
<a name="line-20"></a><span class='hs-comment'>-- settings (e.g., so that you can trace only particular things you</span>
<a name="line-21"></a><span class='hs-comment'>-- are interested in.)  It's important to note that the instances</span>
<a name="line-22"></a><span class='hs-comment'>-- for 'Verbosity' assume that this does not exist.</span>
<a name="line-23"></a>
<a name="line-24"></a><span class='hs-comment'>-- Verbosity for Cabal functions.</span>
<a name="line-25"></a>
<a name="line-26"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution</span><span class='hs-varop'>.</span><span class='hs-conid'>Verbosity</span> <span class='hs-layout'>(</span>
<a name="line-27"></a>  <span class='hs-comment'>-- * Verbosity</span>
<a name="line-28"></a>  <span class='hs-conid'>Verbosity</span><span class='hs-layout'>,</span>
<a name="line-29"></a>  <span class='hs-varid'>silent</span><span class='hs-layout'>,</span> <span class='hs-varid'>normal</span><span class='hs-layout'>,</span> <span class='hs-varid'>verbose</span><span class='hs-layout'>,</span> <span class='hs-varid'>deafening</span><span class='hs-layout'>,</span>
<a name="line-30"></a>  <span class='hs-varid'>moreVerbose</span><span class='hs-layout'>,</span> <span class='hs-varid'>lessVerbose</span><span class='hs-layout'>,</span> <span class='hs-varid'>isVerboseQuiet</span><span class='hs-layout'>,</span>
<a name="line-31"></a>  <span class='hs-varid'>intToVerbosity</span><span class='hs-layout'>,</span> <span class='hs-varid'>flagToVerbosity</span><span class='hs-layout'>,</span>
<a name="line-32"></a>  <span class='hs-varid'>showForCabal</span><span class='hs-layout'>,</span> <span class='hs-varid'>showForGHC</span><span class='hs-layout'>,</span>
<a name="line-33"></a>  <span class='hs-varid'>verboseNoFlags</span><span class='hs-layout'>,</span> <span class='hs-varid'>verboseHasFlags</span><span class='hs-layout'>,</span>
<a name="line-34"></a>
<a name="line-35"></a>  <span class='hs-comment'>-- * Call stacks</span>
<a name="line-36"></a>  <span class='hs-varid'>verboseCallSite</span><span class='hs-layout'>,</span> <span class='hs-varid'>verboseCallStack</span><span class='hs-layout'>,</span>
<a name="line-37"></a>  <span class='hs-varid'>isVerboseCallSite</span><span class='hs-layout'>,</span> <span class='hs-varid'>isVerboseCallStack</span><span class='hs-layout'>,</span>
<a name="line-38"></a>
<a name="line-39"></a>  <span class='hs-comment'>-- * Output markets</span>
<a name="line-40"></a>  <span class='hs-varid'>verboseMarkOutput</span><span class='hs-layout'>,</span> <span class='hs-varid'>isVerboseMarkOutput</span><span class='hs-layout'>,</span>
<a name="line-41"></a>  <span class='hs-varid'>verboseUnmarkOutput</span><span class='hs-layout'>,</span>
<a name="line-42"></a>
<a name="line-43"></a>  <span class='hs-comment'>-- * line-wrapping</span>
<a name="line-44"></a>  <span class='hs-varid'>verboseNoWrap</span><span class='hs-layout'>,</span> <span class='hs-varid'>isVerboseNoWrap</span><span class='hs-layout'>,</span>
<a name="line-45"></a> <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-conid'>()</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution</span><span class='hs-varop'>.</span><span class='hs-conid'>Compat</span><span class='hs-varop'>.</span><span class='hs-conid'>Prelude</span>
<a name="line-49"></a>
<a name="line-50"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution</span><span class='hs-varop'>.</span><span class='hs-conid'>ReadE</span>
<a name="line-51"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution</span><span class='hs-varop'>.</span><span class='hs-conid'>Compat</span><span class='hs-varop'>.</span><span class='hs-conid'>ReadP</span>
<a name="line-52"></a>
<a name="line-53"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>elemIndex</span><span class='hs-layout'>)</span>
<a name="line-54"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-layout'>)</span>
<a name="line-55"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Set</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="Verbosity"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Verbosity</span> <span class='hs-layout'>{</span>
<a name="line-58"></a>    <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VerbosityLevel</span><span class='hs-layout'>,</span>
<a name="line-59"></a>    <span class='hs-varid'>vFlags</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Set</span> <span class='hs-conid'>VerbosityFlag</span><span class='hs-layout'>,</span>
<a name="line-60"></a>    <span class='hs-varid'>vQuiet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>
<a name="line-61"></a>  <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>)</span>
<a name="line-62"></a>
<a name="line-63"></a><a name="mkVerbosity"></a><span class='hs-definition'>mkVerbosity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VerbosityLevel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-64"></a><span class='hs-definition'>mkVerbosity</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Verbosity</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>vFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>,</span> <span class='hs-varid'>vQuiet</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span> <span class='hs-layout'>}</span>
<a name="line-65"></a>
<a name="line-66"></a><a name="instance%20Show%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-67"></a>    <span class='hs-varid'>showsPrec</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>showsPrec</span> <span class='hs-varid'>n</span> <span class='hs-varop'>.</span> <span class='hs-varid'>vLevel</span>
<a name="line-68"></a>
<a name="line-69"></a><a name="instance%20Read%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Read</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-70"></a>    <span class='hs-varid'>readsPrec</span> <span class='hs-varid'>n</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>readsPrec</span> <span class='hs-varid'>n</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-71"></a>
<a name="line-72"></a><a name="instance%20Eq%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Eq</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-73"></a>    <span class='hs-varid'>x</span> <span class='hs-varop'>==</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vLevel</span> <span class='hs-varid'>x</span> <span class='hs-varop'>==</span> <span class='hs-varid'>vLevel</span> <span class='hs-varid'>y</span>
<a name="line-74"></a>
<a name="line-75"></a><a name="instance%20Ord%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-76"></a>    <span class='hs-varid'>compare</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compare</span> <span class='hs-layout'>(</span><span class='hs-varid'>vLevel</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>vLevel</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="instance%20Enum%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-79"></a>    <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toEnum</span>
<a name="line-80"></a>    <span class='hs-varid'>fromEnum</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varop'>.</span> <span class='hs-varid'>vLevel</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="instance%20Bounded%20Verbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Bounded</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyword'>where</span>
<a name="line-83"></a>    <span class='hs-varid'>minBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-varid'>minBound</span>
<a name="line-84"></a>    <span class='hs-varid'>maxBound</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-varid'>maxBound</span>
<a name="line-85"></a>
<a name="line-86"></a><a name="instance%20Binary%20Verbosity%20data%20VerbosityLevel%20=%20Silent%20%7c%20Normal%20%7c%20Verbose%20%7c%20Deafening%20deriving%20(Generic,%20Show,%20Read,%20Eq,%20Ord,%20Enum,%20Bounded)%20instance%20Binary%20VerbosityLevel%20--%20We%20shouldn't%20print%20/anything/%20unless%20an%20error%20occurs%20in%20silent%20mode%20silent%20::%20Verbosity%20silent%20=%20mkVerbosity%20Silent%20--%20Print%20stuff%20we%20want%20to%20see%20by%20default%20normal%20::%20Verbosity%20normal%20=%20mkVerbosity%20Normal%20--%20Be%20more%20verbose%20about%20what's%20going%20on%20verbose%20::%20Verbosity%20verbose%20=%20mkVerbosity%20Verbose%20--%20Not%20only%20are%20we%20verbose%20ourselves%20(perhaps%20even%20noisier%20than%20when%20--%20being%20%22verbose%22),%20but%20we%20tell%20everything%20we%20run%20to%20be%20verbose%20too%20deafening%20::%20Verbosity%20deafening%20=%20mkVerbosity%20Deafening%20moreVerbose%20::%20Verbosity%20-%3e%20Verbosity%20moreVerbose%20v%20=%20case%20vLevel%20v%20of%20Silent%20-%3e%20v%20--%20silent%20should%20stay%20silent%20Normal%20-%3e%20v%20%7b%20vLevel%20=%20Verbose%20%7d%20Verbose%20-%3e%20v%20%7b%20vLevel%20=%20Deafening%20%7d%20Deafening%20-%3e%20v%20lessVerbose%20::%20Verbosity%20-%3e%20Verbosity%20lessVerbose%20v%20=%20verboseQuiet%20$%20case%20vLevel%20v%20of%20Deafening%20-%3e%20v%20--%20deafening%20stays%20deafening%20Verbose%20-%3e%20v%20%7b%20vLevel%20=%20Normal%20%7d%20Normal%20-%3e%20v%20%7b%20vLevel%20=%20Silent%20%7d%20Silent%20-%3e%20v%20intToVerbosity%20::%20Int%20-%3e%20Maybe%20Verbosity%20intToVerbosity%200%20=%20Just%20(mkVerbosity%20Silent)%20intToVerbosity%201%20=%20Just%20(mkVerbosity%20Normal)%20intToVerbosity%202%20=%20Just%20(mkVerbosity%20Verbose)%20intToVerbosity%203%20=%20Just%20(mkVerbosity%20Deafening)%20intToVerbosity%20_%20=%20Nothing%20parseVerbosity%20::%20ReadP%20r%20(Either%20Int%20Verbosity)%20parseVerbosity%20=%20parseIntVerbosity%20%3c++%20parseStringVerbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>Verbosity</span>
<a name="line-87"></a>
<a name="line-88"></a><a name="VerbosityLevel"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>VerbosityLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Silent</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Normal</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Verbose</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Deafening</span>
<a name="line-89"></a>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span><span class='hs-layout'>)</span>
<a name="line-90"></a>
<a name="line-91"></a><a name="instance%20Binary%20VerbosityLevel%20--%20We%20shouldn't%20print%20/anything/%20unless%20an%20error%20occurs%20in%20silent%20mode%20silent%20::%20Verbosity%20silent%20=%20mkVerbosity%20Silent%20--%20Print%20stuff%20we%20want%20to%20see%20by%20default%20normal%20::%20Verbosity%20normal%20=%20mkVerbosity%20Normal%20--%20Be%20more%20verbose%20about%20what's%20going%20on%20verbose%20::%20Verbosity%20verbose%20=%20mkVerbosity%20Verbose%20--%20Not%20only%20are%20we%20verbose%20ourselves%20(perhaps%20even%20noisier%20than%20when%20--%20being%20%22verbose%22),%20but%20we%20tell%20everything%20we%20run%20to%20be%20verbose%20too%20deafening%20::%20Verbosity%20deafening%20=%20mkVerbosity%20Deafening%20moreVerbose%20::%20Verbosity%20-%3e%20Verbosity%20moreVerbose%20v%20=%20case%20vLevel%20v%20of%20Silent%20-%3e%20v%20--%20silent%20should%20stay%20silent%20Normal%20-%3e%20v%20%7b%20vLevel%20=%20Verbose%20%7d%20Verbose%20-%3e%20v%20%7b%20vLevel%20=%20Deafening%20%7d%20Deafening%20-%3e%20v%20lessVerbose%20::%20Verbosity%20-%3e%20Verbosity%20lessVerbose%20v%20=%20verboseQuiet%20$%20case%20vLevel%20v%20of%20Deafening%20-%3e%20v%20--%20deafening%20stays%20deafening%20Verbose%20-%3e%20v%20%7b%20vLevel%20=%20Normal%20%7d%20Normal%20-%3e%20v%20%7b%20vLevel%20=%20Silent%20%7d%20Silent%20-%3e%20v%20intToVerbosity%20::%20Int%20-%3e%20Maybe%20Verbosity%20intToVerbosity%200%20=%20Just%20(mkVerbosity%20Silent)%20intToVerbosity%201%20=%20Just%20(mkVerbosity%20Normal)%20intToVerbosity%202%20=%20Just%20(mkVerbosity%20Verbose)%20intToVerbosity%203%20=%20Just%20(mkVerbosity%20Deafening)%20intToVerbosity%20_%20=%20Nothing%20parseVerbosity%20::%20ReadP%20r%20(Either%20Int%20Verbosity)%20parseVerbosity%20=%20parseIntVerbosity%20%3c++%20parseStringVerbosity"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>VerbosityLevel</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="silent"></a><span class='hs-comment'>-- We shouldn't print /anything/ unless an error occurs in silent mode</span>
<a name="line-94"></a><span class='hs-definition'>silent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span>
<a name="line-95"></a><span class='hs-definition'>silent</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Silent</span>
<a name="line-96"></a>
<a name="line-97"></a><a name="normal"></a><span class='hs-comment'>-- Print stuff we want to see by default</span>
<a name="line-98"></a><span class='hs-definition'>normal</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span>
<a name="line-99"></a><span class='hs-definition'>normal</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Normal</span>
<a name="line-100"></a>
<a name="line-101"></a><a name="verbose"></a><span class='hs-comment'>-- Be more verbose about what's going on</span>
<a name="line-102"></a><span class='hs-definition'>verbose</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span>
<a name="line-103"></a><span class='hs-definition'>verbose</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Verbose</span>
<a name="line-104"></a>
<a name="line-105"></a><a name="deafening"></a><span class='hs-comment'>-- Not only are we verbose ourselves (perhaps even noisier than when</span>
<a name="line-106"></a><span class='hs-comment'>-- being "verbose"), but we tell everything we run to be verbose too</span>
<a name="line-107"></a><span class='hs-definition'>deafening</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span>
<a name="line-108"></a><span class='hs-definition'>deafening</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Deafening</span>
<a name="line-109"></a>
<a name="line-110"></a><a name="moreVerbose"></a><span class='hs-definition'>moreVerbose</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-111"></a><span class='hs-definition'>moreVerbose</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span>
<a name="line-112"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>vLevel</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>of</span>
<a name="line-113"></a>        <span class='hs-conid'>Silent</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-- silent should stay silent</span>
<a name="line-114"></a>        <span class='hs-conid'>Normal</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Verbose</span> <span class='hs-layout'>}</span>
<a name="line-115"></a>        <span class='hs-conid'>Verbose</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Deafening</span> <span class='hs-layout'>}</span>
<a name="line-116"></a>        <span class='hs-conid'>Deafening</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span>
<a name="line-117"></a>
<a name="line-118"></a><a name="lessVerbose"></a><span class='hs-definition'>lessVerbose</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-119"></a><span class='hs-definition'>lessVerbose</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span>
<a name="line-120"></a>    <span class='hs-varid'>verboseQuiet</span> <span class='hs-varop'>$</span>
<a name="line-121"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>vLevel</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>of</span>
<a name="line-122"></a>        <span class='hs-conid'>Deafening</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-- deafening stays deafening</span>
<a name="line-123"></a>        <span class='hs-conid'>Verbose</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Normal</span> <span class='hs-layout'>}</span>
<a name="line-124"></a>        <span class='hs-conid'>Normal</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Silent</span> <span class='hs-layout'>}</span>
<a name="line-125"></a>        <span class='hs-conid'>Silent</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span>
<a name="line-126"></a>
<a name="line-127"></a><a name="intToVerbosity"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Verbosity</span>
<a name="line-128"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Silent</span><span class='hs-layout'>)</span>
<a name="line-129"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Normal</span><span class='hs-layout'>)</span>
<a name="line-130"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-num'>2</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Verbose</span><span class='hs-layout'>)</span>
<a name="line-131"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-num'>3</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-conid'>Deafening</span><span class='hs-layout'>)</span>
<a name="line-132"></a><span class='hs-definition'>intToVerbosity</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-133"></a>
<a name="line-134"></a><a name="parseVerbosity"></a><span class='hs-definition'>parseVerbosity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ReadP</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Int</span> <span class='hs-conid'>Verbosity</span><span class='hs-layout'>)</span>
<a name="line-135"></a><span class='hs-definition'>parseVerbosity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parseIntVerbosity</span> <span class='hs-varop'>&lt;++</span> <span class='hs-varid'>parseStringVerbosity</span>
<a name="line-136"></a>  <span class='hs-keyword'>where</span>
<a name="line-137"></a>    <span class='hs-varid'>parseIntVerbosity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-varid'>readS_to_P</span> <span class='hs-varid'>reads</span><span class='hs-layout'>)</span>
<a name="line-138"></a>    <span class='hs-varid'>parseStringVerbosity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-conid'>Right</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-139"></a>        <span class='hs-varid'>level</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>parseVerbosityLevel</span>
<a name="line-140"></a>        <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>skipSpaces</span>
<a name="line-141"></a>        <span class='hs-varid'>extras</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sepBy</span> <span class='hs-varid'>parseExtra</span> <span class='hs-varid'>skipSpaces</span>
<a name="line-142"></a>        <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldr</span> <span class='hs-layout'>(</span><span class='hs-varop'>.</span><span class='hs-layout'>)</span> <span class='hs-varid'>id</span> <span class='hs-varid'>extras</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkVerbosity</span> <span class='hs-varid'>level</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-143"></a>    <span class='hs-varid'>parseVerbosityLevel</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>choice</span>
<a name="line-144"></a>        <span class='hs-keyglyph'>[</span> <span class='hs-varid'>string</span> <span class='hs-str'>"silent"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Silent</span>
<a name="line-145"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"normal"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Normal</span>
<a name="line-146"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"verbose"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Verbose</span>
<a name="line-147"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"debug"</span>  <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Deafening</span>
<a name="line-148"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"deafening"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Deafening</span>
<a name="line-149"></a>        <span class='hs-keyglyph'>]</span>
<a name="line-150"></a>    <span class='hs-varid'>parseExtra</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'+'</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>choice</span>
<a name="line-151"></a>        <span class='hs-keyglyph'>[</span> <span class='hs-varid'>string</span> <span class='hs-str'>"callsite"</span>  <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varid'>verboseCallSite</span>
<a name="line-152"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"callstack"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varid'>verboseCallStack</span>
<a name="line-153"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"nowrap"</span>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varid'>verboseNoWrap</span>
<a name="line-154"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>string</span> <span class='hs-str'>"markoutput"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varid'>verboseMarkOutput</span>
<a name="line-155"></a>        <span class='hs-keyglyph'>]</span>
<a name="line-156"></a>
<a name="line-157"></a><a name="flagToVerbosity"></a><span class='hs-definition'>flagToVerbosity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ReadE</span> <span class='hs-conid'>Verbosity</span>
<a name="line-158"></a><span class='hs-definition'>flagToVerbosity</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ReadE</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-159"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>readP_to_S</span> <span class='hs-layout'>(</span><span class='hs-varid'>parseVerbosity</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>eof</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-160"></a>       <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-varid'>i</span><span class='hs-layout'>,</span> <span class='hs-str'>""</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-161"></a>           <span class='hs-keyword'>case</span> <span class='hs-varid'>intToVerbosity</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-162"></a>               <span class='hs-conid'>Just</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>v</span>
<a name="line-163"></a>               <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-str'>"Bad verbosity: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>i</span> <span class='hs-varop'>++</span>
<a name="line-164"></a>                                     <span class='hs-str'>". Valid values are 0..3"</span><span class='hs-layout'>)</span>
<a name="line-165"></a>       <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Right</span> <span class='hs-varid'>v</span><span class='hs-layout'>,</span> <span class='hs-str'>""</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>v</span>
<a name="line-166"></a>       <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Left</span> <span class='hs-layout'>(</span><span class='hs-str'>"Can't parse verbosity "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-167"></a>
<a name="line-168"></a><a name="showForCabal"></a><span class='hs-definition'>showForCabal</span><span class='hs-layout'>,</span> <span class='hs-varid'>showForGHC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-169"></a>
<a name="line-170"></a><span class='hs-definition'>showForCabal</span> <span class='hs-varid'>v</span>
<a name="line-171"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>null</span> <span class='hs-layout'>(</span><span class='hs-varid'>vFlags</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<a name="line-172"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>error</span> <span class='hs-str'>"unknown verbosity"</span><span class='hs-layout'>)</span> <span class='hs-varid'>show</span> <span class='hs-varop'>$</span>
<a name="line-173"></a>        <span class='hs-varid'>elemIndex</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>silent</span><span class='hs-layout'>,</span><span class='hs-varid'>normal</span><span class='hs-layout'>,</span><span class='hs-varid'>verbose</span><span class='hs-layout'>,</span><span class='hs-varid'>deafening</span><span class='hs-keyglyph'>]</span>
<a name="line-174"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-175"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unwords</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-keyword'>case</span> <span class='hs-varid'>vLevel</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>of</span>
<a name="line-176"></a>                    <span class='hs-conid'>Silent</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-str'>"silent"</span>
<a name="line-177"></a>                    <span class='hs-conid'>Normal</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-str'>"normal"</span>
<a name="line-178"></a>                    <span class='hs-conid'>Verbose</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-str'>"verbose"</span>
<a name="line-179"></a>                    <span class='hs-conid'>Deafening</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-str'>"debug"</span><span class='hs-layout'>)</span>
<a name="line-180"></a>              <span class='hs-conop'>:</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>showFlag</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>toList</span> <span class='hs-layout'>(</span><span class='hs-varid'>vFlags</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-181"></a>  <span class='hs-keyword'>where</span>
<a name="line-182"></a>    <span class='hs-varid'>showFlag</span> <span class='hs-conid'>VCallSite</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"+callsite"</span><span class='hs-keyglyph'>]</span>
<a name="line-183"></a>    <span class='hs-varid'>showFlag</span> <span class='hs-conid'>VCallStack</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"+callstack"</span><span class='hs-keyglyph'>]</span>
<a name="line-184"></a>    <span class='hs-varid'>showFlag</span> <span class='hs-conid'>VNoWrap</span>     <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"+nowrap"</span><span class='hs-keyglyph'>]</span>
<a name="line-185"></a>    <span class='hs-varid'>showFlag</span> <span class='hs-conid'>VMarkOutput</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"+markoutput"</span><span class='hs-keyglyph'>]</span>
<a name="line-186"></a><a name="showForGHC"></a><span class='hs-definition'>showForGHC</span>   <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>error</span> <span class='hs-str'>"unknown verbosity"</span><span class='hs-layout'>)</span> <span class='hs-varid'>show</span> <span class='hs-varop'>$</span>
<a name="line-187"></a>    <span class='hs-varid'>elemIndex</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>silent</span><span class='hs-layout'>,</span><span class='hs-varid'>normal</span><span class='hs-layout'>,</span><span class='hs-sel'>__</span><span class='hs-layout'>,</span><span class='hs-varid'>verbose</span><span class='hs-layout'>,</span><span class='hs-varid'>deafening</span><span class='hs-keyglyph'>]</span>
<a name="line-188"></a>        <span class='hs-keyword'>where</span> <span class='hs-sel'>__</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>silent</span> <span class='hs-comment'>-- this will be always ignored by elemIndex</span>
<a name="line-189"></a>
<a name="line-190"></a><a name="VerbosityFlag"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>VerbosityFlag</span>
<a name="line-191"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VCallStack</span>
<a name="line-192"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>VCallSite</span>
<a name="line-193"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>VNoWrap</span>
<a name="line-194"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>VMarkOutput</span>
<a name="line-195"></a>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span><span class='hs-layout'>,</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span><span class='hs-layout'>)</span>
<a name="line-196"></a>
<a name="line-197"></a><a name="instance%20Binary%20VerbosityFlag%20--%20%7c%20Turn%20on%20verbose%20call-site%20printing%20when%20we%20log.%20verboseCallSite%20::%20Verbosity%20-%3e%20Verbosity%20verboseCallSite%20=%20verboseFlag%20VCallSite%20--%20%7c%20Turn%20on%20verbose%20call-stack%20printing%20when%20we%20log.%20verboseCallStack%20::%20Verbosity%20-%3e%20Verbosity%20verboseCallStack%20=%20verboseFlag%20VCallStack%20--%20%7c%20Turn%20on%20@-----BEGIN%20CABAL%20OUTPUT-----@%20markers%20for%20output%20--%20from%20Cabal%20(as%20opposed%20to%20GHC,%20or%20system%20dependent).%20verboseMarkOutput%20::%20Verbosity%20-%3e%20Verbosity%20verboseMarkOutput%20=%20verboseFlag%20VMarkOutput%20--%20%7c%20Turn%20off%20marking;%20useful%20for%20suppressing%20nondeterministic%20output.%20verboseUnmarkOutput%20::%20Verbosity%20-%3e%20Verbosity%20verboseUnmarkOutput%20v%20=%20v%20%7b%20vFlags%20=%20Set.delete%20VMarkOutput%20(vFlags%20v)%20%7d%20--%20%7c%20Disable%20line-wrapping%20for%20log%20messages.%20verboseNoWrap%20::%20Verbosity%20-%3e%20Verbosity%20verboseNoWrap%20=%20verboseFlag%20VNoWrap%20--%20%7c%20Mark%20the%20verbosity%20as%20quiet%20verboseQuiet%20::%20Verbosity%20-%3e%20Verbosity%20verboseQuiet%20v%20=%20v%20%7b%20vQuiet%20=%20True%20%7d%20--%20%7c%20Helper%20function%20for%20flag%20toggling%20functions%20verboseFlag%20::%20VerbosityFlag%20-%3e%20(Verbosity%20-%3e%20Verbosity)%20verboseFlag%20flag%20v%20=%20v%20%7b%20vFlags%20=%20Set.insert%20flag%20(vFlags%20v)%20%7d%20verboseNoFlags%20::%20Verbosity%20-%3e%20Verbosity%20verboseNoFlags%20v%20=%20v%20%7b%20vFlags%20=%20Set.empty%20%7d%20verboseHasFlags%20::%20Verbosity%20-%3e%20Bool%20verboseHasFlags%20=%20not%20.%20Set.null%20.%20vFlags%20--%20%7c%20Test%20if%20we%20should%20output%20call%20sites%20when%20we%20log.%20isVerboseCallSite%20::%20Verbosity%20-%3e%20Bool%20isVerboseCallSite%20=%20isVerboseFlag%20VCallSite%20--%20%7c%20Test%20if%20we%20should%20output%20call%20stacks%20when%20we%20log.%20isVerboseCallStack%20::%20Verbosity%20-%3e%20Bool%20isVerboseCallStack%20=%20isVerboseFlag%20VCallStack%20--%20%7c%20Test%20if%20we%20should%20output%20markets.%20isVerboseMarkOutput%20::%20Verbosity%20-%3e%20Bool%20isVerboseMarkOutput%20=%20isVerboseFlag%20VMarkOutput%20--%20%7c%20Test%20if%20line-wrapping%20is%20disabled%20for%20log%20messages.%20isVerboseNoWrap%20::%20Verbosity%20-%3e%20Bool%20isVerboseNoWrap%20=%20isVerboseFlag%20VNoWrap%20--%20%7c%20Test%20if%20we%20had%20called%20'lessVerbose'%20on%20the%20verbosity%20isVerboseQuiet%20::%20Verbosity%20-%3e%20Bool%20isVerboseQuiet%20=%20vQuiet%20--%20%7c%20Helper%20function%20for%20flag%20testing%20functions.%20isVerboseFlag%20::%20VerbosityFlag%20-%3e%20Verbosity%20-%3e%20Bool%20isVerboseFlag%20flag%20=%20(Set.member%20flag)%20.%20vFlags"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>VerbosityFlag</span>
<a name="line-198"></a>
<a name="line-199"></a><a name="verboseCallSite"></a><span class='hs-comment'>-- | Turn on verbose call-site printing when we log.</span>
<a name="line-200"></a><span class='hs-definition'>verboseCallSite</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-201"></a><span class='hs-definition'>verboseCallSite</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>verboseFlag</span> <span class='hs-conid'>VCallSite</span>
<a name="line-202"></a>
<a name="line-203"></a><a name="verboseCallStack"></a><span class='hs-comment'>-- | Turn on verbose call-stack printing when we log.</span>
<a name="line-204"></a><span class='hs-definition'>verboseCallStack</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-205"></a><span class='hs-definition'>verboseCallStack</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>verboseFlag</span> <span class='hs-conid'>VCallStack</span>
<a name="line-206"></a>
<a name="line-207"></a><a name="verboseMarkOutput"></a><span class='hs-comment'>-- | Turn on @-----BEGIN CABAL OUTPUT-----@ markers for output</span>
<a name="line-208"></a><span class='hs-comment'>-- from Cabal (as opposed to GHC, or system dependent).</span>
<a name="line-209"></a><span class='hs-definition'>verboseMarkOutput</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-210"></a><span class='hs-definition'>verboseMarkOutput</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>verboseFlag</span> <span class='hs-conid'>VMarkOutput</span>
<a name="line-211"></a>
<a name="line-212"></a><a name="verboseUnmarkOutput"></a><span class='hs-comment'>-- | Turn off marking; useful for suppressing nondeterministic output.</span>
<a name="line-213"></a><span class='hs-definition'>verboseUnmarkOutput</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-214"></a><span class='hs-definition'>verboseUnmarkOutput</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>delete</span> <span class='hs-conid'>VMarkOutput</span> <span class='hs-layout'>(</span><span class='hs-varid'>vFlags</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-215"></a>
<a name="line-216"></a><a name="verboseNoWrap"></a><span class='hs-comment'>-- | Disable line-wrapping for log messages.</span>
<a name="line-217"></a><span class='hs-definition'>verboseNoWrap</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-218"></a><span class='hs-definition'>verboseNoWrap</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>verboseFlag</span> <span class='hs-conid'>VNoWrap</span>
<a name="line-219"></a>
<a name="line-220"></a><a name="verboseQuiet"></a><span class='hs-comment'>-- | Mark the verbosity as quiet</span>
<a name="line-221"></a><span class='hs-definition'>verboseQuiet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-222"></a><span class='hs-definition'>verboseQuiet</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vQuiet</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span> <span class='hs-layout'>}</span>
<a name="line-223"></a>
<a name="line-224"></a><a name="verboseFlag"></a><span class='hs-comment'>-- | Helper function for flag toggling functions</span>
<a name="line-225"></a><span class='hs-definition'>verboseFlag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VerbosityFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span><span class='hs-layout'>)</span>
<a name="line-226"></a><span class='hs-definition'>verboseFlag</span> <span class='hs-varid'>flag</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>flag</span> <span class='hs-layout'>(</span><span class='hs-varid'>vFlags</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-227"></a>
<a name="line-228"></a><a name="verboseNoFlags"></a><span class='hs-definition'>verboseNoFlags</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span>
<a name="line-229"></a><span class='hs-definition'>verboseNoFlags</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>v</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span> <span class='hs-layout'>}</span>
<a name="line-230"></a>
<a name="line-231"></a><a name="verboseHasFlags"></a><span class='hs-definition'>verboseHasFlags</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-232"></a><span class='hs-definition'>verboseHasFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>null</span> <span class='hs-varop'>.</span> <span class='hs-varid'>vFlags</span>
<a name="line-233"></a>
<a name="line-234"></a><a name="isVerboseCallSite"></a><span class='hs-comment'>-- | Test if we should output call sites when we log.</span>
<a name="line-235"></a><span class='hs-definition'>isVerboseCallSite</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-236"></a><span class='hs-definition'>isVerboseCallSite</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVerboseFlag</span> <span class='hs-conid'>VCallSite</span>
<a name="line-237"></a>
<a name="line-238"></a><a name="isVerboseCallStack"></a><span class='hs-comment'>-- | Test if we should output call stacks when we log.</span>
<a name="line-239"></a><span class='hs-definition'>isVerboseCallStack</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-240"></a><span class='hs-definition'>isVerboseCallStack</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVerboseFlag</span> <span class='hs-conid'>VCallStack</span>
<a name="line-241"></a>
<a name="line-242"></a><a name="isVerboseMarkOutput"></a><span class='hs-comment'>-- | Test if we should output markets.</span>
<a name="line-243"></a><span class='hs-definition'>isVerboseMarkOutput</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-244"></a><span class='hs-definition'>isVerboseMarkOutput</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVerboseFlag</span> <span class='hs-conid'>VMarkOutput</span>
<a name="line-245"></a>
<a name="line-246"></a><a name="isVerboseNoWrap"></a><span class='hs-comment'>-- | Test if line-wrapping is disabled for log messages.</span>
<a name="line-247"></a><span class='hs-definition'>isVerboseNoWrap</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-248"></a><span class='hs-definition'>isVerboseNoWrap</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVerboseFlag</span> <span class='hs-conid'>VNoWrap</span>
<a name="line-249"></a>
<a name="line-250"></a><a name="isVerboseQuiet"></a><span class='hs-comment'>-- | Test if we had called 'lessVerbose' on the verbosity</span>
<a name="line-251"></a><span class='hs-definition'>isVerboseQuiet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-252"></a><span class='hs-definition'>isVerboseQuiet</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vQuiet</span>
<a name="line-253"></a>
<a name="line-254"></a><a name="isVerboseFlag"></a><span class='hs-comment'>-- | Helper function for flag testing functions.</span>
<a name="line-255"></a><span class='hs-definition'>isVerboseFlag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VerbosityFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Verbosity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-256"></a><span class='hs-definition'>isVerboseFlag</span> <span class='hs-varid'>flag</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>member</span> <span class='hs-varid'>flag</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>vFlags</span>
</pre></body>
</html>
